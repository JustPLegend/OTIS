<!DOCTYPE html>

<html>

<head>
  <title>Simple light IOT</title>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
<style>
  .jumbotron {
    background-color: #7d09d3;
    color: #fff;
  }


  .square1 {
    background-color: yellow;
    width: 100px;
    height: 100px;

  }

  .square2 {
    background-color: darkblue;
    width: 100px;
    height: 100px;
  }

  .square3 {
    background-color: green;
    width: 100px;
    height: 100px;
  }

  h4 {

    font-family: 'Times New Roman', Times, serif;
  }
</style>

<body>


  <div class="container">
    <div class="jumbotron">
      <h1>DRIOT </h1>

      <p>“Tell me and I forget, teach me and I may remember, involve me and I learn.”</p>

      <a href="https://tinyurl.com/signInArduino"> Sign In Arduino </a>
    </div>
    
    <h4> Dekorativne svjetiljke izumio je Carl Otis, zaposlenik u NOMA Electric Company 1940 – ih. NOMA je tada prodavala na milione svake godine. U 21 vijeku, 
      kada je tehnologija napredovala možemo da koristimo LED svjetla za ukrašavanje jelke, domova, poslovnih objekata tokom čitave godine
    </h4>

  </div>



  <div class="container">
    <div class="row">

      <div align="center" class="col-md-4">
        <!---green--->
        <h4> GREEN LIGHT </h4>
        <div class="square3"> </div>
      </div>

      <div align="center" class="col-md-4">
        <!-- yellow light-->

        <h4> YELLOW LIGHT </h4>
        <div class="square1"> </div>
      </div>


      <div align="center" class="col-md-4">
        <!---darkblue--->
        <h4> DARK BLUE LIGHT </h4>
        <div class="square2"> </div>
      </div>



    </div>
    <!--class row-->
  </div>
  <!--container-->
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-database.js"></script>

  <script>
    const firebaseConfig = {

      apiKey: "AIzaSyCnLuWDJDOuUmBvdiUkp2dLYJ9I93zC2zA",

      authDomain: "jpl-app.firebaseapp.com",

      databaseURL: "https://jpl-app-default-rtdb.europe-west1.firebasedatabase.app",

      projectId: "jpl-app",

      storageBucket: "jpl-app.appspot.com",

      messagingSenderId: "1035340751332",

      appId: "1:1035340751332:web:9938fa284a213a9ddca7f1"

    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let zelena = document.querySelector('.square3');
    let zuta = document.querySelector('.square1');
    let plava = document.querySelector('.square2');
    let on_off;
    let modVar;
    let defaultValue;
    
    db.ref('/Glavni/Dugme').on('value', snap => {
      on_off=snap.val(); 
      if (on_off== true) {
        zelena.style.opacity = 1;
        zuta.style.opacity = 1;
        plava.style.opacity = 1;  
      }
      else if (on_off == false) {
        zelena.style.opacity = 0;
        zuta.style.opacity = 0;
        plava.style.opacity = 0;
        db.ref('/Glavni/Mod').set(0);
      }
    });

    //BUG: Kad se postavi mode1, pa se ugasi ,pa se ponovo upali 1 ostaje u bazi podataka, ali ne učitava na stranicu

    
    db.ref('/Glavni/Mod').on('value', mod => {
      //reset nam iz izgasenog vraca u upaljeno
      modVar=mod.val();
      if(mod.val()==1&&on_off==true){
        
        for(let i=0;i<10;i++){

          setTimeout(()=>{
            zelena.style.opacity=1
          },1000);
          setTimeout(()=>{
            zelena.style.opacity=0
          },2000);
          setTimeout(()=>{
            zelena.style.opacity=1
          },3000);
          setTimeout(()=>{
            zuta.style.opacity=0
          },4000);
          setTimeout(()=>{
            zuta.style.opacity=1
          },5000);
          setTimeout(()=>{
            plava.style.opacity=0
          },6000);
          etTimeout(()=>{
            plava.style.opacity=1
          },7000);
        }
        
        
      }
      else if(mod.val()==0&&on_off==true){
        zelena.style.opacity = 1;
        zuta.style.opacity = 1;
        plava.style.opacity = 1; 
      }
    });
   
    

    </script>

</body>

</html>